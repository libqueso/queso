<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>queso-0.57.0: src/contrib/ANN/src/bd_tree.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">queso-0.57.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_974a4f9b5986246761932d409834af31.html">src</a></li><li class="navelem"><a class="el" href="dir_5ebf0f177932fe2ba181ddb3e6398119.html">contrib</a></li><li class="navelem"><a class="el" href="dir_67b7d72f59e2a5482e20d8653f81e008.html">ANN</a></li><li class="navelem"><a class="el" href="dir_fa82fbc2dbc4619088671a6166e0274d.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">bd_tree.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00318.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// File:                        bd_tree.cpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Programmer:          David Mount</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Description:         Basic methods for bd-trees.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Last modified:       01/04/05 (Version 1.0)</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Copyright (c) 1997-2005 University of Maryland and Sunil Arya and</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// David Mount.  All Rights Reserved.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This software and related documentation is part of the Approximate</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Nearest Neighbor Library (ANN).  This software is provided under</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// the provisions of the Lesser GNU Public License (LGPL).  See the</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// file ../ReadMe.txt for further information.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// The University of Maryland (U.M.) and the authors make no</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// representations about the suitability or fitness of this software for</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// any purpose.  It is provided &quot;as is&quot; without express or implied</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// warranty.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// History:</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//      Revision 0.1  03/04/98</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//              Initial release</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//      Revision l.0  04/01/05</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//              Fixed centroid shrink threshold condition to depend on the</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//                      dimension.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//              Moved dump routine to kd_dump.cpp.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00319.html">bd_tree.h</a>&quot;</span>                                    <span class="comment">// bd-tree declarations</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00333.html">kd_util.h</a>&quot;</span>                                    <span class="comment">// kd-tree utilities</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00329.html">kd_split.h</a>&quot;</span>                                   <span class="comment">// kd-tree splitting rules</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00309.html">ANN/ANNperf.h</a>&gt;</span>                                <span class="comment">// performance evaluation</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//      Printing a bd-tree</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//              These routines print a bd-tree.   See the analogous procedure</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//              in kd_tree.cpp for more information.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="a00014.html#a41b772faa781609ff39da6a269c16662">   41</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00014.html#a41b772faa781609ff39da6a269c16662">ANNbd_shrink::print</a>(                               <span class="comment">// print shrinking node</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                <span class="keywordtype">int</span> level,                                              <span class="comment">// depth of node in tree</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                ostream &amp;out)                                   <span class="comment">// output stream</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="a00014.html#a6b50ec4569620af69946e62106eeb5a7">child</a>[<a class="code" href="a00310.html#adf764cbdea00d65edcd07bb9953ad2b7a74d342c79fc6125d2b51326d62ce597c">ANN_OUT</a>]-&gt;<a class="code" href="a00018.html#ab76fe2fbdfa4affa3ffce96675a1c887">print</a>(level+1, out);            <span class="comment">// print out-child</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        out &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; level; i++)                         <span class="comment">// print indentation</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                out &lt;&lt; <span class="stringliteral">&quot;..&quot;</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        out &lt;&lt; <span class="stringliteral">&quot;Shrink&quot;</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="a00014.html#aa39fd79dab4163b3ff8a0af60fec9742">n_bnds</a>; j++) {                      <span class="comment">// print sides, 2 per line</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                <span class="keywordflow">if</span> (j % 2 == 0) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                        out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;                                            <span class="comment">// newline and indentation</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; level+2; i++) out &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                out &lt;&lt; <span class="stringliteral">&quot;  ([&quot;</span> &lt;&lt; <a class="code" href="a00014.html#af37a99b5d5b1c460e31ea5b9ca994e3f">bnds</a>[j].<a class="code" href="a00023.html#a67e9aeae5ad346ef5f60006c57f2e5ff">cd</a> &lt;&lt; <span class="stringliteral">&quot;]&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                         &lt;&lt; (<a class="code" href="a00014.html#af37a99b5d5b1c460e31ea5b9ca994e3f">bnds</a>[j].<a class="code" href="a00023.html#a6c82e0ac63314e6051cd0117da94b553">sd</a> &gt; 0 ? <span class="stringliteral">&quot;&gt;=&quot;</span> : <span class="stringliteral">&quot;&lt; &quot;</span>)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                         &lt;&lt; <a class="code" href="a00014.html#af37a99b5d5b1c460e31ea5b9ca994e3f">bnds</a>[j].cv &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="a00014.html#a6b50ec4569620af69946e62106eeb5a7">child</a>[<a class="code" href="a00310.html#adf764cbdea00d65edcd07bb9953ad2b7a0d2aaac2cc3bb72be73ecfa346e35fa9">ANN_IN</a>]-&gt;<a class="code" href="a00018.html#ab76fe2fbdfa4affa3ffce96675a1c887">print</a>(level+1, out);                     <span class="comment">// print in-child</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//      kd_tree statistics utility (for performance evaluation)</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//              This routine computes various statistics information for</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//              shrinking nodes.  See file kd_tree.cpp for more information.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="a00014.html#a37a635b661ebb1b18ec6ab68df92a2b4">   71</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00014.html#a37a635b661ebb1b18ec6ab68df92a2b4">ANNbd_shrink::getStats</a>(                                    <span class="comment">// get subtree statistics</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordtype">int</span>                                     <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>,                                    <span class="comment">// dimension of space</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="a00021.html">ANNkdStats</a>                      &amp;st,                                    <span class="comment">// stats (modified)</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="a00024.html">ANNorthRect</a>                     &amp;bnd_box)                               <span class="comment">// bounding box</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="a00021.html">ANNkdStats</a> ch_stats;                                            <span class="comment">// stats for children</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="a00024.html">ANNorthRect</a> inner_box(dim);                                     <span class="comment">// inner box of shrink</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="a00332.html#ab9e52de33c0c32dd9b27eb58d78fb7e4">annBnds2Box</a>(bnd_box,                                            <span class="comment">// enclosing box</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                dim,                                                    <span class="comment">// dimension</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                <a class="code" href="a00014.html#aa39fd79dab4163b3ff8a0af60fec9742">n_bnds</a>,                                                 <span class="comment">// number of bounds</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                <a class="code" href="a00014.html#af37a99b5d5b1c460e31ea5b9ca994e3f">bnds</a>,                                                   <span class="comment">// bounds array</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                inner_box);                                             <span class="comment">// inner box (modified)</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                                                                                <span class="comment">// get stats for inner child</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        ch_stats.<a class="code" href="a00021.html#a7ebff910ff7fa893e8528989b0091b11">reset</a>();                                                       <span class="comment">// reset</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="a00014.html#a6b50ec4569620af69946e62106eeb5a7">child</a>[<a class="code" href="a00310.html#adf764cbdea00d65edcd07bb9953ad2b7a0d2aaac2cc3bb72be73ecfa346e35fa9">ANN_IN</a>]-&gt;<a class="code" href="a00018.html#a8e18026bd3a10d3b2fed0f8dbbfd1bcf">getStats</a>(dim, ch_stats, inner_box);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        st.<a class="code" href="a00021.html#abec3668063ce9eebd2e134e665abe290">merge</a>(ch_stats);                                                     <span class="comment">// merge them</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                                                                                <span class="comment">// get stats for outer child</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        ch_stats.<a class="code" href="a00021.html#a7ebff910ff7fa893e8528989b0091b11">reset</a>();                                                       <span class="comment">// reset</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="a00014.html#a6b50ec4569620af69946e62106eeb5a7">child</a>[<a class="code" href="a00310.html#adf764cbdea00d65edcd07bb9953ad2b7a74d342c79fc6125d2b51326d62ce597c">ANN_OUT</a>]-&gt;<a class="code" href="a00018.html#a8e18026bd3a10d3b2fed0f8dbbfd1bcf">getStats</a>(dim, ch_stats, bnd_box);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        st.<a class="code" href="a00021.html#abec3668063ce9eebd2e134e665abe290">merge</a>(ch_stats);                                                     <span class="comment">// merge them</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        st.<a class="code" href="a00021.html#acc4bc70f06a2b1819668cc8f7295f1f0">depth</a>++;                                                                     <span class="comment">// increment depth</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        st.<a class="code" href="a00021.html#a1c502a8489754676991facb606a649e8">n_shr</a>++;                                                                     <span class="comment">// increment number of shrinks</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">// bd-tree constructor</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">//              This is the main constructor for bd-trees given a set of points.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//              It first builds a skeleton kd-tree as a basis, then computes the</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//              bounding box of the data points, and then invokes rbd_tree() to</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//              actually build the tree, passing it the appropriate splitting</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//              and shrinking information.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<a class="code" href="a00018.html">ANNkd_ptr</a> <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(                                             <span class="comment">// recursive construction of bd-tree</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="a00308.html#a402299ac00a81ad80f09a0eb84ba4059">ANNpointArray</a>           pa,                             <span class="comment">// point array</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="a00308.html#a6cc54f9929727736423d719870cf1a5b">ANNidxArray</a>                     pidx,                   <span class="comment">// point indices to store in subtree</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordtype">int</span>                                     n,                              <span class="comment">// number of points</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordtype">int</span>                                     <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>,                    <span class="comment">// dimension of space</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordtype">int</span>                                     bsp,                    <span class="comment">// bucket space</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="a00024.html">ANNorthRect</a>                     &amp;bnd_box,               <span class="comment">// bounding box for current node</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="a00331.html#a0cbd4f81e97e97a48ccdf5227f04aa80">ANNkd_splitter</a>          splitter,               <span class="comment">// splitting routine</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8c">ANNshrinkRule</a>           <a class="code" href="a00337.html#a487329335f7a6eb9975346d4d996de94">shrink</a>);                <span class="comment">// shrinking rule</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="a00015.html#affc85f82bf003672cb9b05176617fee8">  116</a></span>&#160;<a class="code" href="a00015.html#a6f947fa8ce26e0ccae9dd1b7651a5e1f">ANNbd_tree::ANNbd_tree</a>(                                 <span class="comment">// construct from point array</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="a00308.html#a402299ac00a81ad80f09a0eb84ba4059">ANNpointArray</a>           pa,                             <span class="comment">// point array (with at least n pts)</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">int</span>                                     n,                              <span class="comment">// number of points</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordtype">int</span>                                     dd,                             <span class="comment">// dimension</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordtype">int</span>                                     bs,                             <span class="comment">// bucket size</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="a00308.html#a229eef95deefadc9d3fa738683c9c2bb">ANNsplitRule</a>            <a class="code" href="a00337.html#a5f710f2ea1568580da33d7d678165850">split</a>,                  <span class="comment">// splitting rule</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8c">ANNshrinkRule</a>           <a class="code" href="a00337.html#a487329335f7a6eb9975346d4d996de94">shrink</a>)                 <span class="comment">// shrinking rule</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        : <a class="code" href="a00020.html">ANNkd_tree</a>(n, dd, bs)                         <span class="comment">// build skeleton base tree</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="a00020.html#a1cfebcb6bc0c5799ca63742be94252e3">pts</a> = pa;                                                       <span class="comment">// where the points are</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">if</span> (n == 0) <span class="keywordflow">return</span>;                                     <span class="comment">// no points--no sweat</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="a00024.html">ANNorthRect</a> bnd_box(dd);                        <span class="comment">// bounding box for points</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                                                                <span class="comment">// construct bounding rectangle</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <a class="code" href="a00332.html#a6ed5406b7e20d7f1b0a15c0d21354f77">annEnclRect</a>(pa, <a class="code" href="a00020.html#ab6e9412675e56af6e6cebcc012dadd00">pidx</a>, n, dd, bnd_box);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                                                <span class="comment">// copy to tree structure</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="a00020.html#a67b75c59ccbeba75df32e3d1ea6575ea">bnd_box_lo</a> = <a class="code" href="a00308.html#a4d699aa9bd46a0c0bf91c25252da80e0">annCopyPt</a>(dd, bnd_box.<a class="code" href="a00024.html#af8c0d718f4c7b98b2e437235da2c9de0">lo</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="a00020.html#a58438fdbae2c04ee3bcd6ec507fb59d9">bnd_box_hi</a> = <a class="code" href="a00308.html#a4d699aa9bd46a0c0bf91c25252da80e0">annCopyPt</a>(dd, bnd_box.<a class="code" href="a00024.html#a4183b43fb488ab030f6f5ed2e81e3578">hi</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">switch</span> (split) {                                        <span class="comment">// build by rule</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba33c8110b750dedbe3e585bfe1371b35f">ANN_KD_STD</a>:                                        <span class="comment">// standard kd-splitting rule</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <a class="code" href="a00020.html#a260fdbf0352880655eba84b271d30351">root</a> = <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(pa, <a class="code" href="a00020.html#ab6e9412675e56af6e6cebcc012dadd00">pidx</a>, n, dd, bs, bnd_box, <a class="code" href="a00328.html#a40f559e8137bf18a6f072d33d40fabb6">kd_split</a>, shrink);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba269ec3c64e6a211889803403e3db8c08">ANN_KD_MIDPT</a>:                                      <span class="comment">// midpoint split</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <a class="code" href="a00020.html#a260fdbf0352880655eba84b271d30351">root</a> = <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(pa, <a class="code" href="a00020.html#ab6e9412675e56af6e6cebcc012dadd00">pidx</a>, n, dd, bs, bnd_box, <a class="code" href="a00328.html#a7709666b3446757acd5589b4aaa14784">midpt_split</a>, shrink);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba9998b60fada03ec8867d9ee448ac4ea7">ANN_KD_SUGGEST</a>:                            <span class="comment">// best (in our opinion)</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a229eef95deefadc9d3fa738683c9c2bbac8e375f7efb04af5ff833dac2095bc50">ANN_KD_SL_MIDPT</a>:                           <span class="comment">// sliding midpoint split</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <a class="code" href="a00020.html#a260fdbf0352880655eba84b271d30351">root</a> = <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(pa, <a class="code" href="a00020.html#ab6e9412675e56af6e6cebcc012dadd00">pidx</a>, n, dd, bs, bnd_box, <a class="code" href="a00328.html#a6d5f8c8dc552d75ade33052dc7f20ab7">sl_midpt_split</a>, shrink);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba120e2bf3c00d785a8deeaa911aa0762d">ANN_KD_FAIR</a>:                                       <span class="comment">// fair split</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <a class="code" href="a00020.html#a260fdbf0352880655eba84b271d30351">root</a> = <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(pa, <a class="code" href="a00020.html#ab6e9412675e56af6e6cebcc012dadd00">pidx</a>, n, dd, bs, bnd_box, <a class="code" href="a00328.html#ab6167ffd4cda270c15d2eca1bbce4e9d">fair_split</a>, shrink);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba55cf23b5fd13fc8ca54d1e3c4a04d0fb">ANN_KD_SL_FAIR</a>:                            <span class="comment">// sliding fair split</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <a class="code" href="a00020.html#a260fdbf0352880655eba84b271d30351">root</a> = <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(pa, <a class="code" href="a00020.html#ab6e9412675e56af6e6cebcc012dadd00">pidx</a>, n, dd, bs,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                                bnd_box, <a class="code" href="a00328.html#ae4399675d75267ad56169a2072c7a2ba">sl_fair_split</a>, shrink);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <a class="code" href="a00310.html#a9c45d5ab29fad7c514d22008daf15534">annError</a>(<span class="stringliteral">&quot;Illegal splitting method&quot;</span>, <a class="code" href="a00310.html#a13bdbb0af13b1a99636a383f628469d4ac74a434b098f1c98aa9c2fbdd2e93524">ANNabort</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">//      Shrinking rules</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1a7cf1f5924560c2c48f72f6e1a462e9c9">  162</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1">ANNdecomp</a> {<a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1a7cf1f5924560c2c48f72f6e1a462e9c9">SPLIT</a>, <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1af14d86ba10483fa11e17e193561e9951">SHRINK</a>};                 <span class="comment">// decomposition methods</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">//      trySimpleShrink - Attempt a simple shrink</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">//              We compute the tight bounding box of the points, and compute</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">//              the 2*dim ``gaps&#39;&#39; between the sides of the tight box and the</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">//              bounding box.  If any of the gaps is large enough relative to</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">//              the longest side of the tight bounding box, then we shrink</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">//              all sides whose gaps are large enough.  (The reason for</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">//              comparing against the tight bounding box, is that after</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">//              shrinking the longest box size will decrease, and if we use</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//              the standard bounding box, we may decide to shrink twice in</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">//              a row.  Since the tight box is fixed, we cannot shrink twice</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">//              consecutively.)</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="a00318.html#ae7f4c19694bd08d4fcbc08bdbabe9cd6">  178</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="a00318.html#ae7f4c19694bd08d4fcbc08bdbabe9cd6">BD_GAP_THRESH</a> = 0.5;                <span class="comment">// gap threshold (must be &lt; 1)</span></div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="a00318.html#a8e29622e6257ea7203d496f02b35aac2">  179</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span>   <a class="code" href="a00318.html#a8e29622e6257ea7203d496f02b35aac2">BD_CT_THRESH</a>  = 2;                  <span class="comment">// min number of shrink sides</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="a00318.html#a759c10464cd5cc31f03f2db13c4b6a09">  181</a></span>&#160;<a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1">ANNdecomp</a> <a class="code" href="a00318.html#a759c10464cd5cc31f03f2db13c4b6a09">trySimpleShrink</a>(                              <span class="comment">// try a simple shrink</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="a00308.html#a402299ac00a81ad80f09a0eb84ba4059">ANNpointArray</a>           pa,                             <span class="comment">// point array</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="a00308.html#a6cc54f9929727736423d719870cf1a5b">ANNidxArray</a>                     pidx,                   <span class="comment">// point indices to store in subtree</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordtype">int</span>                                     n,                              <span class="comment">// number of points</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordtype">int</span>                                     <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>,                    <span class="comment">// dimension of space</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00024.html">ANNorthRect</a>       &amp;bnd_box,               <span class="comment">// current bounding box</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="a00024.html">ANNorthRect</a>                     &amp;inner_box)             <span class="comment">// inner box if shrinking (returned)</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                                                                                <span class="comment">// compute tight bounding box</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <a class="code" href="a00332.html#a6ed5406b7e20d7f1b0a15c0d21354f77">annEnclRect</a>(pa, pidx, n, dim, inner_box);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="a00308.html#ab066cd4e4fffad67a16b64d9a28a86e4">ANNcoord</a> max_length = 0;                                        <span class="comment">// find longest box side</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>; i++) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <a class="code" href="a00308.html#ab066cd4e4fffad67a16b64d9a28a86e4">ANNcoord</a> length = inner_box.<a class="code" href="a00024.html#a4183b43fb488ab030f6f5ed2e81e3578">hi</a>[i] - inner_box.<a class="code" href="a00024.html#af8c0d718f4c7b98b2e437235da2c9de0">lo</a>[i];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordflow">if</span> (length &gt; max_length) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        max_length = length;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordtype">int</span> shrink_ct = 0;                                                      <span class="comment">// number of sides we shrunk</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>; i++) {                                     <span class="comment">// select which sides to shrink</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                                                                                <span class="comment">// gap between boxes</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <a class="code" href="a00308.html#ab066cd4e4fffad67a16b64d9a28a86e4">ANNcoord</a> gap_hi = bnd_box.<a class="code" href="a00024.html#a4183b43fb488ab030f6f5ed2e81e3578">hi</a>[i] - inner_box.<a class="code" href="a00024.html#a4183b43fb488ab030f6f5ed2e81e3578">hi</a>[i];</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                                                                                <span class="comment">// big enough gap to shrink?</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="keywordflow">if</span> (gap_hi &lt; max_length*<a class="code" href="a00318.html#ae7f4c19694bd08d4fcbc08bdbabe9cd6">BD_GAP_THRESH</a>)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        inner_box.<a class="code" href="a00024.html#a4183b43fb488ab030f6f5ed2e81e3578">hi</a>[i] = bnd_box.<a class="code" href="a00024.html#a4183b43fb488ab030f6f5ed2e81e3578">hi</a>[i];        <span class="comment">// no - expand</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keywordflow">else</span> shrink_ct++;                                               <span class="comment">// yes - shrink this side</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                                                                                <span class="comment">// repeat for high side</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <a class="code" href="a00308.html#ab066cd4e4fffad67a16b64d9a28a86e4">ANNcoord</a> gap_lo = inner_box.<a class="code" href="a00024.html#af8c0d718f4c7b98b2e437235da2c9de0">lo</a>[i] - bnd_box.<a class="code" href="a00024.html#af8c0d718f4c7b98b2e437235da2c9de0">lo</a>[i];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">if</span> (gap_lo &lt; max_length*BD_GAP_THRESH)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                        inner_box.<a class="code" href="a00024.html#af8c0d718f4c7b98b2e437235da2c9de0">lo</a>[i] = bnd_box.<a class="code" href="a00024.html#af8c0d718f4c7b98b2e437235da2c9de0">lo</a>[i];        <span class="comment">// no - expand</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="keywordflow">else</span> shrink_ct++;                                               <span class="comment">// yes - shrink this side</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (shrink_ct &gt;= <a class="code" href="a00318.html#a8e29622e6257ea7203d496f02b35aac2">BD_CT_THRESH</a>)                          <span class="comment">// did we shrink enough sides?</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                 <span class="keywordflow">return</span> <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1af14d86ba10483fa11e17e193561e9951">SHRINK</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1a7cf1f5924560c2c48f72f6e1a462e9c9">SPLIT</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">//      tryCentroidShrink - Attempt a centroid shrink</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">//      We repeatedly apply the splitting rule, always to the larger subset</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">//      of points, until the number of points decreases by the constant</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">//      fraction BD_FRACTION.  If this takes more than dim*BD_MAX_SPLIT_FAC</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">//      splits for this to happen, then we shrink to the final inner box</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">//      Otherwise we split.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="a00318.html#aecc902378ae4699873bef200e2e6dadb">  232</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span>     <a class="code" href="a00318.html#aecc902378ae4699873bef200e2e6dadb">BD_MAX_SPLIT_FAC</a> = 0.5;         <span class="comment">// maximum number of splits allowed</span></div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="a00318.html#a2d502c8202ce28bdf0830ffc7b568ad4">  233</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span>     <a class="code" href="a00318.html#a2d502c8202ce28bdf0830ffc7b568ad4">BD_FRACTION</a> = 0.5;                      <span class="comment">// ...to reduce points by this fraction</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                                                                <span class="comment">// ...This must be &lt; 1.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="a00318.html#a065d588d28739d479c61c8150bf8a441">  236</a></span>&#160;<a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1">ANNdecomp</a> <a class="code" href="a00318.html#a065d588d28739d479c61c8150bf8a441">tryCentroidShrink</a>(                    <span class="comment">// try a centroid shrink</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="a00308.html#a402299ac00a81ad80f09a0eb84ba4059">ANNpointArray</a>           pa,                             <span class="comment">// point array</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="a00308.html#a6cc54f9929727736423d719870cf1a5b">ANNidxArray</a>                     pidx,                   <span class="comment">// point indices to store in subtree</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordtype">int</span>                                     n,                              <span class="comment">// number of points</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordtype">int</span>                                     <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>,                    <span class="comment">// dimension of space</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00024.html">ANNorthRect</a>       &amp;bnd_box,               <span class="comment">// current bounding box</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="a00331.html#a0cbd4f81e97e97a48ccdf5227f04aa80">ANNkd_splitter</a>          splitter,               <span class="comment">// splitting procedure</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="a00024.html">ANNorthRect</a>                     &amp;inner_box)             <span class="comment">// inner box if shrinking (returned)</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;{</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordtype">int</span> n_sub = n;                                          <span class="comment">// number of points in subset</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordtype">int</span> n_goal = (int) (n*<a class="code" href="a00318.html#a2d502c8202ce28bdf0830ffc7b568ad4">BD_FRACTION</a>); <span class="comment">// number of point in goal</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordtype">int</span> n_splits = 0;                                       <span class="comment">// number of splits needed</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                                                                <span class="comment">// initialize inner box to bounding box</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="a00310.html#aa570fcff6b3af0b516162d102c04c68b">annAssignRect</a>(dim, inner_box, bnd_box);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">while</span> (n_sub &gt; n_goal) {                        <span class="comment">// keep splitting until goal reached</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="keywordtype">int</span> cd;                                                 <span class="comment">// cut dim from splitter (ignored)</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <a class="code" href="a00308.html#ab066cd4e4fffad67a16b64d9a28a86e4">ANNcoord</a> cv;                                    <span class="comment">// cut value from splitter (ignored)</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="keywordtype">int</span> n_lo;                                               <span class="comment">// number of points on low side</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                                                                <span class="comment">// invoke splitting procedure</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                (*splitter)(pa, pidx, inner_box, n_sub, <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>, cd, cv, n_lo);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                n_splits++;                                             <span class="comment">// increment split count</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="keywordflow">if</span> (n_lo &gt;= n_sub/2) {                  <span class="comment">// most points on low side</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        inner_box.hi[cd] = cv;          <span class="comment">// collapse high side</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        n_sub = n_lo;                           <span class="comment">// recurse on lower points</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">else</span> {                                                  <span class="comment">// most points on high side</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                        inner_box.lo[cd] = cv;          <span class="comment">// collapse low side</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                        pidx += n_lo;                           <span class="comment">// recurse on higher points</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        n_sub -= n_lo;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (n_splits &gt; dim*<a class="code" href="a00318.html#aecc902378ae4699873bef200e2e6dadb">BD_MAX_SPLIT_FAC</a>)<span class="comment">// took too many splits</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1af14d86ba10483fa11e17e193561e9951">SHRINK</a>;                                  <span class="comment">// shrink to final subset</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1a7cf1f5924560c2c48f72f6e1a462e9c9">SPLIT</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">//      selectDecomp - select which decomposition to use</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="a00318.html#adeb2d76e77ce2ab143d9867d3cb5b505">  279</a></span>&#160;<a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1">ANNdecomp</a> <a class="code" href="a00318.html#adeb2d76e77ce2ab143d9867d3cb5b505">selectDecomp</a>(                 <span class="comment">// select decomposition method</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="a00308.html#a402299ac00a81ad80f09a0eb84ba4059">ANNpointArray</a>           pa,                             <span class="comment">// point array</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="a00308.html#a6cc54f9929727736423d719870cf1a5b">ANNidxArray</a>                     pidx,                   <span class="comment">// point indices to store in subtree</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordtype">int</span>                                     n,                              <span class="comment">// number of points</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordtype">int</span>                                     <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>,                    <span class="comment">// dimension of space</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00024.html">ANNorthRect</a>       &amp;bnd_box,               <span class="comment">// current bounding box</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="a00331.html#a0cbd4f81e97e97a48ccdf5227f04aa80">ANNkd_splitter</a>          splitter,               <span class="comment">// splitting procedure</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8c">ANNshrinkRule</a>           <a class="code" href="a00337.html#a487329335f7a6eb9975346d4d996de94">shrink</a>,                 <span class="comment">// shrinking rule</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="a00024.html">ANNorthRect</a>                     &amp;inner_box)             <span class="comment">// inner box if shrinking (returned)</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1">ANNdecomp</a> decomp = <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1a7cf1f5924560c2c48f72f6e1a462e9c9">SPLIT</a>;                       <span class="comment">// decomposition</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">switch</span> (shrink) {                                       <span class="comment">// check shrinking rule</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8ca00e2c3dae33e7a522c5f5265d1ce67e5">ANN_BD_NONE</a>:                                       <span class="comment">// no shrinking allowed</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                decomp = <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1a7cf1f5924560c2c48f72f6e1a462e9c9">SPLIT</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8caf9599a9dddddb636d4fb525dc14751bc">ANN_BD_SUGGEST</a>:                            <span class="comment">// author&#39;s suggestion</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8ca9b85530cb7c0f2afd844dd298239beca">ANN_BD_SIMPLE</a>:                                     <span class="comment">// simple shrink</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                decomp = <a class="code" href="a00318.html#a759c10464cd5cc31f03f2db13c4b6a09">trySimpleShrink</a>(</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                pa, pidx,                               <span class="comment">// points and indices</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                n, dim,                                 <span class="comment">// number of points and dimension</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                bnd_box,                                <span class="comment">// current bounding box</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                inner_box);                             <span class="comment">// inner box if shrinking (returned)</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8ca337cef9db4d4b9d7184c912bb5802a9a">ANN_BD_CENTROID</a>:                           <span class="comment">// centroid shrink</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                decomp = <a class="code" href="a00318.html#a065d588d28739d479c61c8150bf8a441">tryCentroidShrink</a>(</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                pa, pidx,                               <span class="comment">// points and indices</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                n, dim,                                 <span class="comment">// number of points and dimension</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                bnd_box,                                <span class="comment">// current bounding box</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                splitter,                               <span class="comment">// splitting procedure</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                inner_box);                             <span class="comment">// inner box if shrinking (returned)</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                <a class="code" href="a00310.html#a9c45d5ab29fad7c514d22008daf15534">annError</a>(<span class="stringliteral">&quot;Illegal shrinking rule&quot;</span>, <a class="code" href="a00310.html#a13bdbb0af13b1a99636a383f628469d4ac74a434b098f1c98aa9c2fbdd2e93524">ANNabort</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">return</span> decomp;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">//      rbd_tree - recursive procedure to build a bd-tree</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">//              This is analogous to rkd_tree, but for bd-trees.  See the</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">//              procedure rkd_tree() in kd_split.cpp for more information.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">//              If the number of points falls below the bucket size, then a</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">//              leaf node is created for the points.  Otherwise we invoke the</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">//              procedure selectDecomp() which determines whether we are to</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">//              split or shrink.  If splitting is chosen, then we essentially</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">//              do exactly as rkd_tree() would, and invoke the specified</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">//              splitting procedure to the points.  Otherwise, the selection</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">//              procedure returns a bounding box, from which we extract the</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">//              appropriate shrinking bounds, and create a shrinking node.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">//              Finally the points are subdivided, and the procedure is</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">//              invoked recursively on the two subsets to form the children.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">  335</a></span>&#160;<a class="code" href="a00018.html">ANNkd_ptr</a> <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(                             <span class="comment">// recursive construction of bd-tree</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="a00308.html#a402299ac00a81ad80f09a0eb84ba4059">ANNpointArray</a>           pa,                             <span class="comment">// point array</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="a00308.html#a6cc54f9929727736423d719870cf1a5b">ANNidxArray</a>                     pidx,                   <span class="comment">// point indices to store in subtree</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordtype">int</span>                                     n,                              <span class="comment">// number of points</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordtype">int</span>                                     <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>,                    <span class="comment">// dimension of space</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordtype">int</span>                                     bsp,                    <span class="comment">// bucket space</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="a00024.html">ANNorthRect</a>                     &amp;bnd_box,               <span class="comment">// bounding box for current node</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <a class="code" href="a00331.html#a0cbd4f81e97e97a48ccdf5227f04aa80">ANNkd_splitter</a>          splitter,               <span class="comment">// splitting routine</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8c">ANNshrinkRule</a>           <a class="code" href="a00337.html#a487329335f7a6eb9975346d4d996de94">shrink</a>)                 <span class="comment">// shrinking rule</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1">ANNdecomp</a> decomp;                                       <span class="comment">// decomposition method</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="a00024.html">ANNorthRect</a> inner_box(dim);                     <span class="comment">// inner box (if shrinking)</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">if</span> (n &lt;= bsp) {                                         <span class="comment">// n small, make a leaf node</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="keywordflow">if</span> (n == 0)                                             <span class="comment">// empty leaf node</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="a00330.html#aefd44c312f0116089b2cfbf80ef5c5c7">KD_TRIVIAL</a>;                      <span class="comment">// return (canonical) empty leaf</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">else</span>                                                    <span class="comment">// construct the node and return</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="a00017.html">ANNkd_leaf</a>(n, pidx);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        decomp = <a class="code" href="a00318.html#adeb2d76e77ce2ab143d9867d3cb5b505">selectDecomp</a>(                          <span class="comment">// select decomposition method</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                pa, pidx,                               <span class="comment">// points and indices</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                n, dim,                                 <span class="comment">// number of points and dimension</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                bnd_box,                                <span class="comment">// current bounding box</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                splitter, shrink,               <span class="comment">// splitting/shrinking methods</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                inner_box);                             <span class="comment">// inner box if shrinking (returned)</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span> (decomp == <a class="code" href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1a7cf1f5924560c2c48f72f6e1a462e9c9">SPLIT</a>) {                          <span class="comment">// split selected</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keywordtype">int</span> cd;                                                 <span class="comment">// cutting dimension</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <a class="code" href="a00308.html#ab066cd4e4fffad67a16b64d9a28a86e4">ANNcoord</a> cv;                                    <span class="comment">// cutting value</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordtype">int</span> n_lo;                                               <span class="comment">// number on low side of cut</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                                                                <span class="comment">// invoke splitting procedure</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                (*splitter)(pa, pidx, bnd_box, n, <a class="code" href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>, cd, cv, n_lo);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <a class="code" href="a00308.html#ab066cd4e4fffad67a16b64d9a28a86e4">ANNcoord</a> lv = bnd_box.lo[cd];   <span class="comment">// save bounds for cutting dimension</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <a class="code" href="a00308.html#ab066cd4e4fffad67a16b64d9a28a86e4">ANNcoord</a> hv = bnd_box.hi[cd];</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                bnd_box.hi[cd] = cv;                    <span class="comment">// modify bounds for left subtree</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <a class="code" href="a00018.html">ANNkd_ptr</a> lo = <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(                <span class="comment">// build left subtree</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                pa, pidx, n_lo,                 <span class="comment">// ...from pidx[0..n_lo-1]</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                dim, bsp, bnd_box, splitter, shrink);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                bnd_box.hi[cd] = hv;                    <span class="comment">// restore bounds</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                bnd_box.lo[cd] = cv;                    <span class="comment">// modify bounds for right subtree</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <a class="code" href="a00018.html">ANNkd_ptr</a> hi = <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(                <span class="comment">// build right subtree</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                pa, pidx + n_lo, n-n_lo,<span class="comment">// ...from pidx[n_lo..n-1]</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                dim, bsp, bnd_box, splitter, shrink);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                bnd_box.lo[cd] = lv;                    <span class="comment">// restore bounds</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                                                                <span class="comment">// create the splitting node</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="a00019.html">ANNkd_split</a>(cd, cv, lv, hv, lo, hi);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">else</span> {                                                          <span class="comment">// shrink selected</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="keywordtype">int</span> n_in;                                               <span class="comment">// number of points in box</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="keywordtype">int</span> n_bnds;                                             <span class="comment">// number of bounding sides</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <a class="code" href="a00332.html#a143da22f78c0a096963e6ef3eff3254a">annBoxSplit</a>(                                    <span class="comment">// split points around inner box</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                pa,                                             <span class="comment">// points to split</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                pidx,                                   <span class="comment">// point indices</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                n,                                              <span class="comment">// number of points</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                dim,                                    <span class="comment">// dimension</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                inner_box,                              <span class="comment">// inner box</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                n_in);                                  <span class="comment">// number of points inside (returned)</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <a class="code" href="a00018.html">ANNkd_ptr</a> in = <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(                <span class="comment">// build inner subtree pidx[0..n_in-1]</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                pa, pidx, n_in, dim, bsp, inner_box, splitter, shrink);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <a class="code" href="a00018.html">ANNkd_ptr</a> out = <a class="code" href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a>(               <span class="comment">// build outer subtree pidx[n_in..n]</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                pa, pidx+n_in, n - n_in, dim, bsp, bnd_box, splitter, shrink);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <a class="code" href="a00023.html">ANNorthHSArray</a> bnds = NULL;             <span class="comment">// bounds (alloc in Box2Bnds and</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                                                                <span class="comment">// ...freed in bd_shrink destroyer)</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <a class="code" href="a00332.html#a01292be79b7bd38cff456094b6ebea6b">annBox2Bnds</a>(                                    <span class="comment">// convert inner box to bounds</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                inner_box,                              <span class="comment">// inner box</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                bnd_box,                                <span class="comment">// enclosing box</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                dim,                                    <span class="comment">// dimension</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                n_bnds,                                 <span class="comment">// number of bounds (returned)</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                bnds);                                  <span class="comment">// bounds array (modified)</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                                                                <span class="comment">// return shrinking node</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="a00014.html">ANNbd_shrink</a>(n_bnds, bnds, in, out);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;}</div>
<div class="ttc" id="a00024_html"><div class="ttname"><a href="a00024.html">ANNorthRect</a></div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00091">ANNx.h:91</a></div></div>
<div class="ttc" id="a00014_html_a37a635b661ebb1b18ec6ab68df92a2b4"><div class="ttname"><a href="a00014.html#a37a635b661ebb1b18ec6ab68df92a2b4">ANNbd_shrink::getStats</a></div><div class="ttdeci">virtual void getStats(int dim, ANNkdStats &amp;st, ANNorthRect &amp;bnd_box)</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00071">bd_tree.cpp:71</a></div></div>
<div class="ttc" id="a00308_html_a6efa97da21b6bc41db3ce4cfbfbe9c8ca00e2c3dae33e7a522c5f5265d1ce67e5"><div class="ttname"><a href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8ca00e2c3dae33e7a522c5f5265d1ce67e5">ANN_BD_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00606">ANN.h:606</a></div></div>
<div class="ttc" id="a00332_html_ab9e52de33c0c32dd9b27eb58d78fb7e4"><div class="ttname"><a href="a00332.html#ab9e52de33c0c32dd9b27eb58d78fb7e4">annBnds2Box</a></div><div class="ttdeci">void annBnds2Box(const ANNorthRect &amp;bnd_box, int dim, int n_bnds, ANNorthHSArray bnds, ANNorthRect &amp;inner_box)</div><div class="ttdef"><b>Definition:</b> <a href="a00332_source.html#l00426">kd_util.cpp:426</a></div></div>
<div class="ttc" id="a00328_html_ab6167ffd4cda270c15d2eca1bbce4e9d"><div class="ttname"><a href="a00328.html#ab6167ffd4cda270c15d2eca1bbce4e9d">fair_split</a></div><div class="ttdeci">void fair_split(ANNpointArray pa, ANNidxArray pidx, const ANNorthRect &amp;bnds, int n, int dim, int &amp;cut_dim, ANNcoord &amp;cut_val, int &amp;n_lo)</div><div class="ttdef"><b>Definition:</b> <a href="a00328_source.html#l00243">kd_split.cpp:243</a></div></div>
<div class="ttc" id="a00023_html_a67e9aeae5ad346ef5f60006c57f2e5ff"><div class="ttname"><a href="a00023.html#a67e9aeae5ad346ef5f60006c57f2e5ff">ANNorthHalfSpace::cd</a></div><div class="ttdeci">int cd</div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00134">ANNx.h:134</a></div></div>
<div class="ttc" id="a00024_html_af8c0d718f4c7b98b2e437235da2c9de0"><div class="ttname"><a href="a00024.html#af8c0d718f4c7b98b2e437235da2c9de0">ANNorthRect::lo</a></div><div class="ttdeci">ANNpoint lo</div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00093">ANNx.h:93</a></div></div>
<div class="ttc" id="a00318_html_ae7f4c19694bd08d4fcbc08bdbabe9cd6"><div class="ttname"><a href="a00318.html#ae7f4c19694bd08d4fcbc08bdbabe9cd6">BD_GAP_THRESH</a></div><div class="ttdeci">const float BD_GAP_THRESH</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00178">bd_tree.cpp:178</a></div></div>
<div class="ttc" id="a00318_html_a4d755a48c58bb5e8df17eebd9ed380c1af14d86ba10483fa11e17e193561e9951"><div class="ttname"><a href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1af14d86ba10483fa11e17e193561e9951">SHRINK</a></div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00162">bd_tree.cpp:162</a></div></div>
<div class="ttc" id="a00328_html_a40f559e8137bf18a6f072d33d40fabb6"><div class="ttname"><a href="a00328.html#a40f559e8137bf18a6f072d33d40fabb6">kd_split</a></div><div class="ttdeci">void kd_split(ANNpointArray pa, ANNidxArray pidx, const ANNorthRect &amp;bnds, int n, int dim, int &amp;cut_dim, ANNcoord &amp;cut_val, int &amp;n_lo)</div><div class="ttdef"><b>Definition:</b> <a href="a00328_source.html#l00044">kd_split.cpp:44</a></div></div>
<div class="ttc" id="a00310_html_aa570fcff6b3af0b516162d102c04c68b"><div class="ttname"><a href="a00310.html#aa570fcff6b3af0b516162d102c04c68b">annAssignRect</a></div><div class="ttdeci">void annAssignRect(int dim, ANNorthRect &amp;dest, const ANNorthRect &amp;source)</div><div class="ttdef"><b>Definition:</b> <a href="a00314_source.html#l00148">ANN.cpp:148</a></div></div>
<div class="ttc" id="a00023_html"><div class="ttname"><a href="a00023.html">ANNorthHalfSpace</a></div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00132">ANNx.h:132</a></div></div>
<div class="ttc" id="a00023_html_a6c82e0ac63314e6051cd0117da94b553"><div class="ttname"><a href="a00023.html#a6c82e0ac63314e6051cd0117da94b553">ANNorthHalfSpace::sd</a></div><div class="ttdeci">int sd</div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00136">ANNx.h:136</a></div></div>
<div class="ttc" id="a00018_html_ab76fe2fbdfa4affa3ffce96675a1c887"><div class="ttname"><a href="a00018.html#ab76fe2fbdfa4affa3ffce96675a1c887">ANNkd_node::print</a></div><div class="ttdeci">virtual void print(int level, ostream &amp;out)=0</div></div>
<div class="ttc" id="a00021_html"><div class="ttname"><a href="a00021.html">ANNkdStats</a></div><div class="ttdef"><b>Definition:</b> <a href="a00309_source.html#l00045">ANNperf.h:45</a></div></div>
<div class="ttc" id="a00308_html_a229eef95deefadc9d3fa738683c9c2bba9998b60fada03ec8867d9ee448ac4ea7"><div class="ttname"><a href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba9998b60fada03ec8867d9ee448ac4ea7">ANN_KD_SUGGEST</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00602">ANN.h:602</a></div></div>
<div class="ttc" id="a00308_html_a229eef95deefadc9d3fa738683c9c2bba55cf23b5fd13fc8ca54d1e3c4a04d0fb"><div class="ttname"><a href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba55cf23b5fd13fc8ca54d1e3c4a04d0fb">ANN_KD_SL_FAIR</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00601">ANN.h:601</a></div></div>
<div class="ttc" id="a00018_html"><div class="ttname"><a href="a00018.html">ANNkd_node</a></div><div class="ttdef"><b>Definition:</b> <a href="a00331_source.html#l00046">kd_tree.h:46</a></div></div>
<div class="ttc" id="a00308_html_a229eef95deefadc9d3fa738683c9c2bba33c8110b750dedbe3e585bfe1371b35f"><div class="ttname"><a href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba33c8110b750dedbe3e585bfe1371b35f">ANN_KD_STD</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00597">ANN.h:597</a></div></div>
<div class="ttc" id="a00308_html_a6efa97da21b6bc41db3ce4cfbfbe9c8caf9599a9dddddb636d4fb525dc14751bc"><div class="ttname"><a href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8caf9599a9dddddb636d4fb525dc14751bc">ANN_BD_SUGGEST</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00609">ANN.h:609</a></div></div>
<div class="ttc" id="a00337_html_a487329335f7a6eb9975346d4d996de94"><div class="ttname"><a href="a00337.html#a487329335f7a6eb9975346d4d996de94">shrink</a></div><div class="ttdeci">ANNshrinkRule shrink</div><div class="ttdef"><b>Definition:</b> <a href="a00337_source.html#l00492">ann_test.cpp:492</a></div></div>
<div class="ttc" id="a00014_html_a41b772faa781609ff39da6a269c16662"><div class="ttname"><a href="a00014.html#a41b772faa781609ff39da6a269c16662">ANNbd_shrink::print</a></div><div class="ttdeci">virtual void print(int level, ostream &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00041">bd_tree.cpp:41</a></div></div>
<div class="ttc" id="a00309_html"><div class="ttname"><a href="a00309.html">ANNperf.h</a></div></div>
<div class="ttc" id="a00024_html_a4183b43fb488ab030f6f5ed2e81e3578"><div class="ttname"><a href="a00024.html#a4183b43fb488ab030f6f5ed2e81e3578">ANNorthRect::hi</a></div><div class="ttdeci">ANNpoint hi</div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00094">ANNx.h:94</a></div></div>
<div class="ttc" id="a00014_html"><div class="ttname"><a href="a00014.html">ANNbd_shrink</a></div><div class="ttdef"><b>Definition:</b> <a href="a00319_source.html#l00061">bd_tree.h:61</a></div></div>
<div class="ttc" id="a00020_html_ab6e9412675e56af6e6cebcc012dadd00"><div class="ttname"><a href="a00020.html#ab6e9412675e56af6e6cebcc012dadd00">ANNkd_tree::pidx</a></div><div class="ttdeci">ANNidxArray pidx</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00711">ANN.h:711</a></div></div>
<div class="ttc" id="a00020_html_a260fdbf0352880655eba84b271d30351"><div class="ttname"><a href="a00020.html#a260fdbf0352880655eba84b271d30351">ANNkd_tree::root</a></div><div class="ttdeci">ANNkd_ptr root</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00712">ANN.h:712</a></div></div>
<div class="ttc" id="a00318_html_a4d755a48c58bb5e8df17eebd9ed380c1"><div class="ttname"><a href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1">ANNdecomp</a></div><div class="ttdeci">ANNdecomp</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00162">bd_tree.cpp:162</a></div></div>
<div class="ttc" id="a00318_html_a4d755a48c58bb5e8df17eebd9ed380c1a7cf1f5924560c2c48f72f6e1a462e9c9"><div class="ttname"><a href="a00318.html#a4d755a48c58bb5e8df17eebd9ed380c1a7cf1f5924560c2c48f72f6e1a462e9c9">SPLIT</a></div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00162">bd_tree.cpp:162</a></div></div>
<div class="ttc" id="a00331_html_a0cbd4f81e97e97a48ccdf5227f04aa80"><div class="ttname"><a href="a00331.html#a0cbd4f81e97e97a48ccdf5227f04aa80">ANNkd_splitter</a></div><div class="ttdeci">void(* ANNkd_splitter)(ANNpointArray pa, ANNidxArray pidx, const ANNorthRect &amp;bnds, int n, int dim, int &amp;cut_dim, ANNcoord &amp;cut_val, int &amp;n_lo)</div><div class="ttdef"><b>Definition:</b> <a href="a00331_source.html#l00072">kd_tree.h:72</a></div></div>
<div class="ttc" id="a00018_html_a8e18026bd3a10d3b2fed0f8dbbfd1bcf"><div class="ttname"><a href="a00018.html#a8e18026bd3a10d3b2fed0f8dbbfd1bcf">ANNkd_node::getStats</a></div><div class="ttdeci">virtual void getStats(int dim, ANNkdStats &amp;st, ANNorthRect &amp;bnd_box)=0</div></div>
<div class="ttc" id="a00328_html_ae4399675d75267ad56169a2072c7a2ba"><div class="ttname"><a href="a00328.html#ae4399675d75267ad56169a2072c7a2ba">sl_fair_split</a></div><div class="ttdeci">void sl_fair_split(ANNpointArray pa, ANNidxArray pidx, const ANNorthRect &amp;bnds, int n, int dim, int &amp;cut_dim, ANNcoord &amp;cut_val, int &amp;n_lo)</div><div class="ttdef"><b>Definition:</b> <a href="a00328_source.html#l00346">kd_split.cpp:346</a></div></div>
<div class="ttc" id="a00308_html_a6efa97da21b6bc41db3ce4cfbfbe9c8c"><div class="ttname"><a href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8c">ANNshrinkRule</a></div><div class="ttdeci">ANNshrinkRule</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00605">ANN.h:605</a></div></div>
<div class="ttc" id="a00329_html"><div class="ttname"><a href="a00329.html">kd_split.h</a></div></div>
<div class="ttc" id="a00017_html"><div class="ttname"><a href="a00017.html">ANNkd_leaf</a></div><div class="ttdef"><b>Definition:</b> <a href="a00331_source.html#l00091">kd_tree.h:91</a></div></div>
<div class="ttc" id="a00310_html_a13bdbb0af13b1a99636a383f628469d4ac74a434b098f1c98aa9c2fbdd2e93524"><div class="ttname"><a href="a00310.html#a13bdbb0af13b1a99636a383f628469d4ac74a434b098f1c98aa9c2fbdd2e93524">ANNabort</a></div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00048">ANNx.h:48</a></div></div>
<div class="ttc" id="a00308_html_a402299ac00a81ad80f09a0eb84ba4059"><div class="ttname"><a href="a00308.html#a402299ac00a81ad80f09a0eb84ba4059">ANNpointArray</a></div><div class="ttdeci">ANNpoint * ANNpointArray</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00376">ANN.h:376</a></div></div>
<div class="ttc" id="a00308_html_a229eef95deefadc9d3fa738683c9c2bba120e2bf3c00d785a8deeaa911aa0762d"><div class="ttname"><a href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba120e2bf3c00d785a8deeaa911aa0762d">ANN_KD_FAIR</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00599">ANN.h:599</a></div></div>
<div class="ttc" id="a00310_html_a9c45d5ab29fad7c514d22008daf15534"><div class="ttname"><a href="a00310.html#a9c45d5ab29fad7c514d22008daf15534">annError</a></div><div class="ttdeci">void annError(const char *msg, ANNerr level)</div><div class="ttdef"><b>Definition:</b> <a href="a00314_source.html#l00169">ANN.cpp:169</a></div></div>
<div class="ttc" id="a00306_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="a00306.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="a00306_source.html#l00081">ann2fig.cpp:81</a></div></div>
<div class="ttc" id="a00020_html"><div class="ttname"><a href="a00020.html">ANNkd_tree</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00705">ANN.h:705</a></div></div>
<div class="ttc" id="a00318_html_aecc902378ae4699873bef200e2e6dadb"><div class="ttname"><a href="a00318.html#aecc902378ae4699873bef200e2e6dadb">BD_MAX_SPLIT_FAC</a></div><div class="ttdeci">const float BD_MAX_SPLIT_FAC</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00232">bd_tree.cpp:232</a></div></div>
<div class="ttc" id="a00318_html_a759c10464cd5cc31f03f2db13c4b6a09"><div class="ttname"><a href="a00318.html#a759c10464cd5cc31f03f2db13c4b6a09">trySimpleShrink</a></div><div class="ttdeci">ANNdecomp trySimpleShrink(ANNpointArray pa, ANNidxArray pidx, int n, int dim, const ANNorthRect &amp;bnd_box, ANNorthRect &amp;inner_box)</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00181">bd_tree.cpp:181</a></div></div>
<div class="ttc" id="a00318_html_a8e29622e6257ea7203d496f02b35aac2"><div class="ttname"><a href="a00318.html#a8e29622e6257ea7203d496f02b35aac2">BD_CT_THRESH</a></div><div class="ttdeci">const int BD_CT_THRESH</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00179">bd_tree.cpp:179</a></div></div>
<div class="ttc" id="a00308_html_a6efa97da21b6bc41db3ce4cfbfbe9c8ca337cef9db4d4b9d7184c912bb5802a9a"><div class="ttname"><a href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8ca337cef9db4d4b9d7184c912bb5802a9a">ANN_BD_CENTROID</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00608">ANN.h:608</a></div></div>
<div class="ttc" id="a00310_html_adf764cbdea00d65edcd07bb9953ad2b7a74d342c79fc6125d2b51326d62ce597c"><div class="ttname"><a href="a00310.html#adf764cbdea00d65edcd07bb9953ad2b7a74d342c79fc6125d2b51326d62ce597c">ANN_OUT</a></div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00046">ANNx.h:46</a></div></div>
<div class="ttc" id="a00308_html_a4d699aa9bd46a0c0bf91c25252da80e0"><div class="ttname"><a href="a00308.html#a4d699aa9bd46a0c0bf91c25252da80e0">annCopyPt</a></div><div class="ttdeci">DLL_API ANNpoint annCopyPt(int dim, ANNpoint source)</div><div class="ttdef"><b>Definition:</b> <a href="a00314_source.html#l00140">ANN.cpp:140</a></div></div>
<div class="ttc" id="a00014_html_a6b50ec4569620af69946e62106eeb5a7"><div class="ttname"><a href="a00014.html#a6b50ec4569620af69946e62106eeb5a7">ANNbd_shrink::child</a></div><div class="ttdeci">ANNkd_ptr child[2]</div><div class="ttdef"><b>Definition:</b> <a href="a00319_source.html#l00065">bd_tree.h:65</a></div></div>
<div class="ttc" id="a00020_html_a67b75c59ccbeba75df32e3d1ea6575ea"><div class="ttname"><a href="a00020.html#a67b75c59ccbeba75df32e3d1ea6575ea">ANNkd_tree::bnd_box_lo</a></div><div class="ttdeci">ANNpoint bnd_box_lo</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00713">ANN.h:713</a></div></div>
<div class="ttc" id="a00318_html_adeb2d76e77ce2ab143d9867d3cb5b505"><div class="ttname"><a href="a00318.html#adeb2d76e77ce2ab143d9867d3cb5b505">selectDecomp</a></div><div class="ttdeci">ANNdecomp selectDecomp(ANNpointArray pa, ANNidxArray pidx, int n, int dim, const ANNorthRect &amp;bnd_box, ANNkd_splitter splitter, ANNshrinkRule shrink, ANNorthRect &amp;inner_box)</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00279">bd_tree.cpp:279</a></div></div>
<div class="ttc" id="a00332_html_a01292be79b7bd38cff456094b6ebea6b"><div class="ttname"><a href="a00332.html#a01292be79b7bd38cff456094b6ebea6b">annBox2Bnds</a></div><div class="ttdeci">void annBox2Bnds(const ANNorthRect &amp;inner_box, const ANNorthRect &amp;bnd_box, int dim, int &amp;n_bnds, ANNorthHSArray &amp;bnds)</div><div class="ttdef"><b>Definition:</b> <a href="a00332_source.html#l00384">kd_util.cpp:384</a></div></div>
<div class="ttc" id="a00328_html_a6d5f8c8dc552d75ade33052dc7f20ab7"><div class="ttname"><a href="a00328.html#a6d5f8c8dc552d75ade33052dc7f20ab7">sl_midpt_split</a></div><div class="ttdeci">void sl_midpt_split(ANNpointArray pa, ANNidxArray pidx, const ANNorthRect &amp;bnds, int n, int dim, int &amp;cut_dim, ANNcoord &amp;cut_val, int &amp;n_lo)</div><div class="ttdef"><b>Definition:</b> <a href="a00328_source.html#l00146">kd_split.cpp:146</a></div></div>
<div class="ttc" id="a00330_html_aefd44c312f0116089b2cfbf80ef5c5c7"><div class="ttname"><a href="a00330.html#aefd44c312f0116089b2cfbf80ef5c5c7">KD_TRIVIAL</a></div><div class="ttdeci">ANNkd_leaf * KD_TRIVIAL</div><div class="ttdef"><b>Definition:</b> <a href="a00330_source.html#l00050">kd_tree.cpp:50</a></div></div>
<div class="ttc" id="a00337_html_a5f710f2ea1568580da33d7d678165850"><div class="ttname"><a href="a00337.html#a5f710f2ea1568580da33d7d678165850">split</a></div><div class="ttdeci">ANNsplitRule split</div><div class="ttdef"><b>Definition:</b> <a href="a00337_source.html#l00491">ann_test.cpp:491</a></div></div>
<div class="ttc" id="a00021_html_a1c502a8489754676991facb606a649e8"><div class="ttname"><a href="a00021.html#a1c502a8489754676991facb606a649e8">ANNkdStats::n_shr</a></div><div class="ttdeci">int n_shr</div><div class="ttdef"><b>Definition:</b> <a href="a00309_source.html#l00053">ANNperf.h:53</a></div></div>
<div class="ttc" id="a00318_html_a4a549ea7feb1fea9a4e349fe9d1b3cf7"><div class="ttname"><a href="a00318.html#a4a549ea7feb1fea9a4e349fe9d1b3cf7">rbd_tree</a></div><div class="ttdeci">ANNkd_ptr rbd_tree(ANNpointArray pa, ANNidxArray pidx, int n, int dim, int bsp, ANNorthRect &amp;bnd_box, ANNkd_splitter splitter, ANNshrinkRule shrink)</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00335">bd_tree.cpp:335</a></div></div>
<div class="ttc" id="a00021_html_abec3668063ce9eebd2e134e665abe290"><div class="ttname"><a href="a00021.html#abec3668063ce9eebd2e134e665abe290">ANNkdStats::merge</a></div><div class="ttdeci">void merge(const ANNkdStats &amp;st)</div><div class="ttdef"><b>Definition:</b> <a href="a00330_source.html#l00133">kd_tree.cpp:133</a></div></div>
<div class="ttc" id="a00333_html"><div class="ttname"><a href="a00333.html">kd_util.h</a></div></div>
<div class="ttc" id="a00014_html_aa39fd79dab4163b3ff8a0af60fec9742"><div class="ttname"><a href="a00014.html#aa39fd79dab4163b3ff8a0af60fec9742">ANNbd_shrink::n_bnds</a></div><div class="ttdeci">int n_bnds</div><div class="ttdef"><b>Definition:</b> <a href="a00319_source.html#l00063">bd_tree.h:63</a></div></div>
<div class="ttc" id="a00308_html_ab066cd4e4fffad67a16b64d9a28a86e4"><div class="ttname"><a href="a00308.html#ab066cd4e4fffad67a16b64d9a28a86e4">ANNcoord</a></div><div class="ttdeci">double ANNcoord</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00158">ANN.h:158</a></div></div>
<div class="ttc" id="a00308_html_a229eef95deefadc9d3fa738683c9c2bba269ec3c64e6a211889803403e3db8c08"><div class="ttname"><a href="a00308.html#a229eef95deefadc9d3fa738683c9c2bba269ec3c64e6a211889803403e3db8c08">ANN_KD_MIDPT</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00598">ANN.h:598</a></div></div>
<div class="ttc" id="a00015_html_a6f947fa8ce26e0ccae9dd1b7651a5e1f"><div class="ttname"><a href="a00015.html#a6f947fa8ce26e0ccae9dd1b7651a5e1f">ANNbd_tree::ANNbd_tree</a></div><div class="ttdeci">ANNbd_tree(int n, int dd, int bs=1)</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00799">ANN.h:799</a></div></div>
<div class="ttc" id="a00332_html_a143da22f78c0a096963e6ef3eff3254a"><div class="ttname"><a href="a00332.html#a143da22f78c0a096963e6ef3eff3254a">annBoxSplit</a></div><div class="ttdeci">void annBoxSplit(ANNpointArray pa, ANNidxArray pidx, int n, int dim, ANNorthRect &amp;box, int &amp;n_in)</div><div class="ttdef"><b>Definition:</b> <a href="a00332_source.html#l00332">kd_util.cpp:332</a></div></div>
<div class="ttc" id="a00332_html_a6ed5406b7e20d7f1b0a15c0d21354f77"><div class="ttname"><a href="a00332.html#a6ed5406b7e20d7f1b0a15c0d21354f77">annEnclRect</a></div><div class="ttdeci">void annEnclRect(ANNpointArray pa, ANNidxArray pidx, int n, int dim, ANNorthRect &amp;bnds)</div><div class="ttdef"><b>Definition:</b> <a href="a00332_source.html#l00073">kd_util.cpp:73</a></div></div>
<div class="ttc" id="a00308_html_a229eef95deefadc9d3fa738683c9c2bb"><div class="ttname"><a href="a00308.html#a229eef95deefadc9d3fa738683c9c2bb">ANNsplitRule</a></div><div class="ttdeci">ANNsplitRule</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00596">ANN.h:596</a></div></div>
<div class="ttc" id="a00308_html_a6efa97da21b6bc41db3ce4cfbfbe9c8ca9b85530cb7c0f2afd844dd298239beca"><div class="ttname"><a href="a00308.html#a6efa97da21b6bc41db3ce4cfbfbe9c8ca9b85530cb7c0f2afd844dd298239beca">ANN_BD_SIMPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00607">ANN.h:607</a></div></div>
<div class="ttc" id="a00020_html_a58438fdbae2c04ee3bcd6ec507fb59d9"><div class="ttname"><a href="a00020.html#a58438fdbae2c04ee3bcd6ec507fb59d9">ANNkd_tree::bnd_box_hi</a></div><div class="ttdeci">ANNpoint bnd_box_hi</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00714">ANN.h:714</a></div></div>
<div class="ttc" id="a00310_html_adf764cbdea00d65edcd07bb9953ad2b7a0d2aaac2cc3bb72be73ecfa346e35fa9"><div class="ttname"><a href="a00310.html#adf764cbdea00d65edcd07bb9953ad2b7a0d2aaac2cc3bb72be73ecfa346e35fa9">ANN_IN</a></div><div class="ttdef"><b>Definition:</b> <a href="a00310_source.html#l00046">ANNx.h:46</a></div></div>
<div class="ttc" id="a00020_html_a1cfebcb6bc0c5799ca63742be94252e3"><div class="ttname"><a href="a00020.html#a1cfebcb6bc0c5799ca63742be94252e3">ANNkd_tree::pts</a></div><div class="ttdeci">ANNpointArray pts</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00710">ANN.h:710</a></div></div>
<div class="ttc" id="a00318_html_a2d502c8202ce28bdf0830ffc7b568ad4"><div class="ttname"><a href="a00318.html#a2d502c8202ce28bdf0830ffc7b568ad4">BD_FRACTION</a></div><div class="ttdeci">const float BD_FRACTION</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00233">bd_tree.cpp:233</a></div></div>
<div class="ttc" id="a00328_html_a7709666b3446757acd5589b4aaa14784"><div class="ttname"><a href="a00328.html#a7709666b3446757acd5589b4aaa14784">midpt_split</a></div><div class="ttdeci">void midpt_split(ANNpointArray pa, ANNidxArray pidx, const ANNorthRect &amp;bnds, int n, int dim, int &amp;cut_dim, ANNcoord &amp;cut_val, int &amp;n_lo)</div><div class="ttdef"><b>Definition:</b> <a href="a00328_source.html#l00076">kd_split.cpp:76</a></div></div>
<div class="ttc" id="a00021_html_a7ebff910ff7fa893e8528989b0091b11"><div class="ttname"><a href="a00021.html#a7ebff910ff7fa893e8528989b0091b11">ANNkdStats::reset</a></div><div class="ttdeci">void reset(int d=0, int n=0, int bs=0)</div><div class="ttdef"><b>Definition:</b> <a href="a00309_source.html#l00059">ANNperf.h:59</a></div></div>
<div class="ttc" id="a00019_html"><div class="ttname"><a href="a00019.html">ANNkd_split</a></div><div class="ttdef"><b>Definition:</b> <a href="a00331_source.html#l00142">kd_tree.h:142</a></div></div>
<div class="ttc" id="a00319_html"><div class="ttname"><a href="a00319.html">bd_tree.h</a></div></div>
<div class="ttc" id="a00308_html_a229eef95deefadc9d3fa738683c9c2bbac8e375f7efb04af5ff833dac2095bc50"><div class="ttname"><a href="a00308.html#a229eef95deefadc9d3fa738683c9c2bbac8e375f7efb04af5ff833dac2095bc50">ANN_KD_SL_MIDPT</a></div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00600">ANN.h:600</a></div></div>
<div class="ttc" id="a00308_html_a6cc54f9929727736423d719870cf1a5b"><div class="ttname"><a href="a00308.html#a6cc54f9929727736423d719870cf1a5b">ANNidxArray</a></div><div class="ttdeci">ANNidx * ANNidxArray</div><div class="ttdef"><b>Definition:</b> <a href="a00308_source.html#l00378">ANN.h:378</a></div></div>
<div class="ttc" id="a00014_html_af37a99b5d5b1c460e31ea5b9ca994e3f"><div class="ttname"><a href="a00014.html#af37a99b5d5b1c460e31ea5b9ca994e3f">ANNbd_shrink::bnds</a></div><div class="ttdeci">ANNorthHSArray bnds</div><div class="ttdef"><b>Definition:</b> <a href="a00319_source.html#l00064">bd_tree.h:64</a></div></div>
<div class="ttc" id="a00318_html_a065d588d28739d479c61c8150bf8a441"><div class="ttname"><a href="a00318.html#a065d588d28739d479c61c8150bf8a441">tryCentroidShrink</a></div><div class="ttdeci">ANNdecomp tryCentroidShrink(ANNpointArray pa, ANNidxArray pidx, int n, int dim, const ANNorthRect &amp;bnd_box, ANNkd_splitter splitter, ANNorthRect &amp;inner_box)</div><div class="ttdef"><b>Definition:</b> <a href="a00318_source.html#l00236">bd_tree.cpp:236</a></div></div>
<div class="ttc" id="a00021_html_acc4bc70f06a2b1819668cc8f7295f1f0"><div class="ttname"><a href="a00021.html#acc4bc70f06a2b1819668cc8f7295f1f0">ANNkdStats::depth</a></div><div class="ttdeci">int depth</div><div class="ttdef"><b>Definition:</b> <a href="a00309_source.html#l00054">ANNperf.h:54</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<hr size="1"/><address style="text-align: right;"><small>
Generated on Sat Apr 22 2017 14:04:35 for queso-0.57.0
by&nbsp;<a href="http://www.doxygen.org/index.html">
<em>doxygen</em></a>
1.8.5</small></address>
</body>
</html>
